<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bill Results | SplitSmart</title>

  <!-- Bootstrap & FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Your custom style -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <div class="container py-4">
    <div class="card upload-card mb-4">
      <div class="card-header">
        <h3 class="mb-0"><i class="fas fa-receipt me-2"></i> Bill Processing Results</h3>
      </div>

      <div class="card-body">
        <div class="row">
          <!-- Left: Original Bill Image -->
          <div class="col-md-6">
            <h4 class="text-dark mb-3">Original Receipt</h4>
            <div class="receipt-image-container">
              {% if receipt_path %}
                <img src="{{ url_for('static', filename=receipt_path) }}" alt="Receipt Image" class="img-fluid receipt-image" style="width: 100%; border-radius: 8px; border: 1px solid #ccc; padding: 10px;" />
              {% else %}
                <img src="#" alt="Original receipt not available" class="img-fluid receipt-image" style="width: 100%; border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                <p class="text-muted mt-2">Original receipt image is not passed to this page from the calculation.</p>
              {% endif %}
            </div>
          </div>

          <!-- Right: Calculated Shares -->
          <div class="col-md-6 results-section">
            <h4>Calculated Shares</h4>

            {% if people %}
              {% for person in people %}
                <div class="person-summary">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5><i class="fas fa-user-circle me-2"></i> {{ person.name }}</h5>
                    <span class="total-amount">₹{{ person.formatted_total }}</span>
                  </div>

                  {% if person["items"] %}
                    <h6>Items:</h6>
                    <ul class="item-list">
                      {% for item in person["items"] %}
                        <li>{{ item.name }} - ₹{{ "%.2f"|format(item.price) }}</li>
                      {% endfor %}
                    </ul>
                  {% else %}
                    <p class="text-muted">No specific items assigned.</p>
                  {% endif %}
                </div>
              {% endfor %}
            {% else %}
              <p class="alert alert-warning">No people data found for calculation.</p>
            {% endif %}

            <div class="grand-total-summary mt-4">
              Original Bill Total: <strong>₹{{ original_total if original_total is not none else '0.00' }}</strong><br>
              Calculated Grand Total: <strong>₹{{ grand_total if grand_total is not none else '0.00' }}</strong>
              <p class="text-muted small mt-2">Any unassigned bill amount (taxes, service charge, unselected items) is split equally among all people.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-4">
      <a href="{{ url_for('home') }}" class="btn btn-split btn-lg">
        <i class="fas fa-arrow-left me-2"></i> Process Another Bill
      </a>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
